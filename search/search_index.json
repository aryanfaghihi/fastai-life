{"config":{"lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Welcome to fastai life This website contains solutions to Kaggle competitions using fastai 2.0 . Use the navbar to find the solutions to competitions.","title":"Home"},{"location":"#welcome-to-fastai-life","text":"This website contains solutions to Kaggle competitions using fastai 2.0 . Use the navbar to find the solutions to competitions.","title":"Welcome to fastai life"},{"location":"about/","text":"About us","title":"About us"},{"location":"about/#about-us","text":"","title":"About us"},{"location":"titanic/","text":"Setup !pip install fastai -U Collecting fastai Downloading fastai-2.0.9-py3-none-any.whl (354 kB) \u001b[K |\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 354 kB 606 kB/s eta 0:00:01 \u001b[?25hRequirement already satisfied, skipping upgrade: packaging in /opt/conda/lib/python3.7/site-packages (from fastai) (20.1) Requirement already satisfied, skipping upgrade: scikit-learn in /opt/conda/lib/python3.7/site-packages (from fastai) (0.23.2) Requirement already satisfied, skipping upgrade: matplotlib in /opt/conda/lib/python3.7/site-packages (from fastai) (3.2.1) Requirement already satisfied, skipping upgrade: pandas in /opt/conda/lib/python3.7/site-packages (from fastai) (1.1.1) Collecting fastcore>=1.0.2 Downloading fastcore-1.0.4-py3-none-any.whl (37 kB) Requirement already satisfied, skipping upgrade: pip in /opt/conda/lib/python3.7/site-packages (from fastai) (20.2.2) Requirement already satisfied, skipping upgrade: fastprogress>=0.2.4 in /opt/conda/lib/python3.7/site-packages (from fastai) (1.0.0) Requirement already satisfied, skipping upgrade: requests in /opt/conda/lib/python3.7/site-packages (from fastai) (2.23.0) Collecting torch>=1.6.0 Downloading torch-1.6.0-cp37-cp37m-manylinux1_x86_64.whl (748.8 MB) \u001b[K |\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 748.8 MB 12 kB/s s eta 0:00:01 |\u2588\u2588 | 46.2 MB 26.8 MB/s eta 0:00:27 |\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e | 309.9 MB 42.0 MB/s eta 0:00:11MB/s eta 0:00:04\ufffd\ufffd\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589 | 674.7 MB 46.3 MB/s eta 0:00:02 \u001b[?25hRequirement already satisfied, skipping upgrade: scipy in /opt/conda/lib/python3.7/site-packages (from fastai) (1.4.1) Requirement already satisfied, skipping upgrade: pyyaml in /opt/conda/lib/python3.7/site-packages (from fastai) (5.3.1) Requirement already satisfied, skipping upgrade: pillow in /opt/conda/lib/python3.7/site-packages (from fastai) (7.2.0) Requirement already satisfied, skipping upgrade: spacy in /opt/conda/lib/python3.7/site-packages (from fastai) (2.2.4) Collecting torchvision>=0.7 Downloading torchvision-0.7.0-cp37-cp37m-manylinux1_x86_64.whl (5.9 MB) \u001b[K |\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 5.9 MB 67.5 MB/s eta 0:00:01 \u001b[?25hRequirement already satisfied, skipping upgrade: six in /opt/conda/lib/python3.7/site-packages (from packaging->fastai) (1.14.0) Requirement already satisfied, skipping upgrade: pyparsing>=2.0.2 in /opt/conda/lib/python3.7/site-packages (from packaging->fastai) (2.4.7) Requirement already satisfied, skipping upgrade: threadpoolctl>=2.0.0 in /opt/conda/lib/python3.7/site-packages (from scikit-learn->fastai) (2.1.0) Requirement already satisfied, skipping upgrade: numpy>=1.13.3 in /opt/conda/lib/python3.7/site-packages (from scikit-learn->fastai) (1.18.5) Requirement already satisfied, skipping upgrade: joblib>=0.11 in /opt/conda/lib/python3.7/site-packages (from scikit-learn->fastai) (0.14.1) Requirement already satisfied, skipping upgrade: kiwisolver>=1.0.1 in /opt/conda/lib/python3.7/site-packages (from matplotlib->fastai) (1.2.0) Requirement already satisfied, skipping upgrade: cycler>=0.10 in /opt/conda/lib/python3.7/site-packages (from matplotlib->fastai) (0.10.0) Requirement already satisfied, skipping upgrade: python-dateutil>=2.1 in /opt/conda/lib/python3.7/site-packages (from matplotlib->fastai) (2.8.1) Requirement already satisfied, skipping upgrade: pytz>=2017.2 in /opt/conda/lib/python3.7/site-packages (from pandas->fastai) (2019.3) Collecting dataclasses Downloading dataclasses-0.6-py3-none-any.whl (14 kB) Requirement already satisfied, skipping upgrade: idna<3,>=2.5 in /opt/conda/lib/python3.7/site-packages (from requests->fastai) (2.9) Requirement already satisfied, skipping upgrade: chardet<4,>=3.0.2 in /opt/conda/lib/python3.7/site-packages (from requests->fastai) (3.0.4) Requirement already satisfied, skipping upgrade: certifi>=2017.4.17 in /opt/conda/lib/python3.7/site-packages (from requests->fastai) (2020.6.20) Requirement already satisfied, skipping upgrade: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /opt/conda/lib/python3.7/site-packages (from requests->fastai) (1.24.3) Requirement already satisfied, skipping upgrade: future in /opt/conda/lib/python3.7/site-packages (from torch>=1.6.0->fastai) (0.18.2) Requirement already satisfied, skipping upgrade: catalogue<1.1.0,>=0.0.7 in /opt/conda/lib/python3.7/site-packages (from spacy->fastai) (1.0.0) Requirement already satisfied, skipping upgrade: srsly<1.1.0,>=1.0.2 in /opt/conda/lib/python3.7/site-packages (from spacy->fastai) (1.0.2) Requirement already satisfied, skipping upgrade: cymem<2.1.0,>=2.0.2 in /opt/conda/lib/python3.7/site-packages (from spacy->fastai) (2.0.3) Requirement already satisfied, skipping upgrade: preshed<3.1.0,>=3.0.2 in /opt/conda/lib/python3.7/site-packages (from spacy->fastai) (3.0.2) Requirement already satisfied, skipping upgrade: tqdm<5.0.0,>=4.38.0 in /opt/conda/lib/python3.7/site-packages (from spacy->fastai) (4.45.0) Requirement already satisfied, skipping upgrade: thinc==7.4.0 in /opt/conda/lib/python3.7/site-packages (from spacy->fastai) (7.4.0) Requirement already satisfied, skipping upgrade: setuptools in /opt/conda/lib/python3.7/site-packages (from spacy->fastai) (46.1.3.post20200325) Requirement already satisfied, skipping upgrade: wasabi<1.1.0,>=0.4.0 in /opt/conda/lib/python3.7/site-packages (from spacy->fastai) (0.7.1) Requirement already satisfied, skipping upgrade: plac<1.2.0,>=0.9.6 in /opt/conda/lib/python3.7/site-packages (from spacy->fastai) (1.1.3) Requirement already satisfied, skipping upgrade: murmurhash<1.1.0,>=0.28.0 in /opt/conda/lib/python3.7/site-packages (from spacy->fastai) (1.0.2) Requirement already satisfied, skipping upgrade: blis<0.5.0,>=0.4.0 in /opt/conda/lib/python3.7/site-packages (from spacy->fastai) (0.4.1) Requirement already satisfied, skipping upgrade: importlib-metadata>=0.20; python_version < \"3.8\" in /opt/conda/lib/python3.7/site-packages (from catalogue<1.1.0,>=0.0.7->spacy->fastai) (1.6.0) Requirement already satisfied, skipping upgrade: zipp>=0.5 in /opt/conda/lib/python3.7/site-packages (from importlib-metadata>=0.20; python_version < \"3.8\"->catalogue<1.1.0,>=0.0.7->spacy->fastai) (3.1.0) Installing collected packages: dataclasses, fastcore, torch, torchvision, fastai Attempting uninstall: torch Found existing installation: torch 1.5.1 Uninstalling torch-1.5.1: Successfully uninstalled torch-1.5.1 Attempting uninstall: torchvision Found existing installation: torchvision 0.6.0a0+35d732a Uninstalling torchvision-0.6.0a0+35d732a: Successfully uninstalled torchvision-0.6.0a0+35d732a Attempting uninstall: fastai Found existing installation: fastai 1.0.61 Uninstalling fastai-1.0.61: Successfully uninstalled fastai-1.0.61 \u001b[31mERROR: After October 2020 you may experience errors when installing or updating packages. This is because pip will change the way that it resolves dependency conflicts. We recommend you use --use-feature=2020-resolver to test your packages with the new resolver before it becomes the default. kornia 0.3.2 requires torch<1.6.0,>=1.5.0, but you'll have torch 1.6.0 which is incompatible. allennlp 1.0.0 requires torch<1.6.0,>=1.5.0, but you'll have torch 1.6.0 which is incompatible.\u001b[0m Successfully installed dataclasses-0.6 fastai-2.0.9 fastcore-1.0.4 torch-1.6.0 torchvision-0.7.0 import fastai fastai.__version__ '2.0.9' from fastai.tabular.all import * Data path = '../input/titanic' train_path = path + '/train.csv' test_path = path + '/test.csv' train = pd.read_csv(train_path) train.head() .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } PassengerId Survived Pclass Name Sex Age SibSp Parch Ticket Fare Cabin Embarked 0 1 0 3 Braund, Mr. Owen Harris male 22.0 1 0 A/5 21171 7.2500 NaN S 1 2 1 1 Cumings, Mrs. John Bradley (Florence Briggs Thayer) female 38.0 1 0 PC 17599 71.2833 C85 C 2 3 1 3 Heikkinen, Miss. Laina female 26.0 0 0 STON/O2. 3101282 7.9250 NaN S 3 4 1 1 Futrelle, Mrs. Jacques Heath (Lily May Peel) female 35.0 1 0 113803 53.1000 C123 S 4 5 0 3 Allen, Mr. William Henry male 35.0 0 0 373450 8.0500 NaN S train.Parch.describe() count 891.000000 mean 0.381594 std 0.806057 min 0.000000 25% 0.000000 50% 0.000000 75% 0.000000 max 6.000000 Name: Parch, dtype: float64 train.columns Index(['PassengerId', 'Survived', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare', 'Cabin', 'Embarked'], dtype='object') splits = RandomSplitter(valid_pct=0.2)(range_of(train)) data = TabularPandas( train, procs=[Categorify, FillMissing,Normalize], cat_names = ['Pclass', 'SibSp', 'Sex', 'Parch','Cabin','Embarked'], cont_names = ['Age','Fare'], y_names='Survived', splits=splits) Train dls = data.dataloaders(bs=64) learn = tabular_learner(dls, metrics=accuracy, cbs=ShowGraphCallback()) learn.fit_one_cycle(150) epoch train_loss valid_loss accuracy time 0 0.395150 0.377600 0.702247 00:00 1 0.366346 0.382785 0.702247 00:00 2 0.339551 0.371797 0.702247 00:00 3 0.310264 0.345113 0.702247 00:00 4 0.281579 0.310483 0.702247 00:00 5 0.253278 0.269912 0.702247 00:00 6 0.228688 0.222490 0.702247 00:00 7 0.206920 0.168250 0.702247 00:00 8 0.187758 0.142423 0.702247 00:00 9 0.173925 0.139804 0.702247 00:00 10 0.159615 0.139614 0.702247 00:00 11 0.148577 0.139325 0.702247 00:00 12 0.138739 0.140137 0.702247 00:00 13 0.130475 0.142085 0.702247 00:00 14 0.124002 0.144857 0.702247 00:00 15 0.118234 0.136231 0.702247 00:00 16 0.114288 0.132554 0.702247 00:00 17 0.110318 0.140191 0.702247 00:00 18 0.107971 0.146698 0.702247 00:00 19 0.106027 0.131402 0.702247 00:00 20 0.104463 0.125868 0.702247 00:00 21 0.101879 0.133761 0.702247 00:00 22 0.101234 0.135055 0.702247 00:00 23 0.099686 0.135643 0.702247 00:00 24 0.098142 0.132391 0.702247 00:00 25 0.096319 0.136855 0.702247 00:00 26 0.095436 0.131195 0.702247 00:00 27 0.094448 0.142192 0.702247 00:00 28 0.093358 0.132326 0.702247 00:00 29 0.093689 0.129051 0.702247 00:00 30 0.092883 0.135105 0.702247 00:00 31 0.092068 0.130766 0.702247 00:00 32 0.091736 0.129940 0.702247 00:00 33 0.091531 0.124503 0.702247 00:00 34 0.091348 0.137747 0.702247 00:00 35 0.091168 0.137324 0.702247 00:00 36 0.090646 0.131917 0.702247 00:00 37 0.090659 0.126318 0.702247 00:00 38 0.089957 0.135028 0.702247 00:00 39 0.088891 0.132661 0.702247 00:00 40 0.088472 0.135807 0.702247 00:00 41 0.089196 0.123606 0.702247 00:00 42 0.088436 0.128096 0.702247 00:00 43 0.087570 0.139201 0.702247 00:00 44 0.087807 0.138244 0.702247 00:00 45 0.087348 0.126612 0.702247 00:00 46 0.086900 0.134935 0.702247 00:00 47 0.085824 0.129363 0.702247 00:00 48 0.085647 0.128131 0.702247 00:00 49 0.084996 0.132883 0.702247 00:00 50 0.084723 0.132393 0.702247 00:00 51 0.085479 0.135473 0.702247 00:00 52 0.085324 0.119682 0.702247 00:00 53 0.084677 0.127057 0.702247 00:00 54 0.083926 0.124037 0.702247 00:00 55 0.083732 0.126720 0.702247 00:00 56 0.083126 0.123772 0.702247 00:00 57 0.082183 0.127085 0.702247 00:00 58 0.081710 0.121816 0.702247 00:00 59 0.081324 0.133650 0.702247 00:00 60 0.080935 0.125411 0.702247 00:00 61 0.079854 0.122429 0.702247 00:00 62 0.079330 0.123147 0.702247 00:00 63 0.078994 0.127851 0.702247 00:00 64 0.078510 0.125835 0.702247 00:00 65 0.078242 0.125809 0.702247 00:00 66 0.078397 0.130970 0.702247 00:00 67 0.078568 0.125747 0.702247 00:00 68 0.078034 0.128503 0.702247 00:00 69 0.077501 0.128943 0.702247 00:00 70 0.078080 0.127008 0.702247 00:00 71 0.078011 0.130303 0.702247 00:00 72 0.078300 0.134184 0.702247 00:00 73 0.078497 0.126999 0.702247 00:00 74 0.077963 0.132503 0.702247 00:00 75 0.077654 0.128828 0.702247 00:00 76 0.077370 0.126126 0.702247 00:00 77 0.077282 0.136550 0.702247 00:00 78 0.077126 0.133494 0.702247 00:00 79 0.077159 0.125807 0.702247 00:00 80 0.076400 0.127987 0.702247 00:00 81 0.076187 0.128587 0.702247 00:00 82 0.076069 0.128721 0.702247 00:00 83 0.076213 0.125016 0.702247 00:00 84 0.075244 0.128486 0.702247 00:00 85 0.075067 0.127430 0.702247 00:00 86 0.074768 0.129118 0.702247 00:00 87 0.074301 0.128410 0.702247 00:00 88 0.074128 0.135739 0.702247 00:00 89 0.074148 0.128045 0.702247 00:00 90 0.073939 0.128453 0.702247 00:00 91 0.073921 0.126086 0.702247 00:00 92 0.074096 0.130053 0.702247 00:00 93 0.073546 0.122949 0.702247 00:00 94 0.073346 0.128125 0.702247 00:00 95 0.073310 0.126533 0.702247 00:00 96 0.073573 0.129317 0.702247 00:00 97 0.073582 0.126800 0.702247 00:00 98 0.073473 0.128594 0.702247 00:00 99 0.073284 0.125200 0.702247 00:00 100 0.072751 0.124738 0.702247 00:00 101 0.072512 0.126146 0.702247 00:00 102 0.071901 0.126788 0.702247 00:00 103 0.071661 0.125302 0.702247 00:00 104 0.071546 0.124029 0.702247 00:00 105 0.072271 0.131001 0.702247 00:00 106 0.071937 0.130682 0.702247 00:00 107 0.071824 0.126480 0.702247 00:00 108 0.071382 0.129221 0.702247 00:00 109 0.070794 0.126628 0.702247 00:00 110 0.070226 0.128316 0.702247 00:00 111 0.069880 0.128169 0.702247 00:00 112 0.069817 0.129248 0.702247 00:00 113 0.069672 0.128678 0.702247 00:00 114 0.069629 0.128300 0.702247 00:00 115 0.069487 0.127129 0.702247 00:00 116 0.069680 0.130046 0.702247 00:00 117 0.070286 0.128519 0.702247 00:00 118 0.070371 0.130455 0.702247 00:00 119 0.069868 0.127835 0.702247 00:00 120 0.069722 0.127997 0.702247 00:00 121 0.069743 0.128846 0.702247 00:00 122 0.069512 0.130303 0.702247 00:00 123 0.069306 0.127954 0.702247 00:00 124 0.069228 0.127648 0.702247 00:00 125 0.068845 0.128368 0.702247 00:00 126 0.068312 0.127970 0.702247 00:00 127 0.068361 0.127761 0.702247 00:00 128 0.068524 0.126953 0.702247 00:00 129 0.068360 0.128105 0.702247 00:00 130 0.067600 0.128017 0.702247 00:00 131 0.067673 0.127634 0.702247 00:00 132 0.067922 0.127794 0.702247 00:00 133 0.067675 0.128400 0.702247 00:00 134 0.067862 0.128138 0.702247 00:00 135 0.067819 0.127842 0.702247 00:00 136 0.067793 0.127731 0.702247 00:00 137 0.067287 0.128053 0.702247 00:00 138 0.067367 0.128029 0.702247 00:00 139 0.067287 0.128088 0.702247 00:00 140 0.067190 0.127882 0.702247 00:00 141 0.067167 0.128510 0.702247 00:00 142 0.067394 0.127965 0.702247 00:00 143 0.067163 0.128741 0.702247 00:00 144 0.067221 0.128624 0.702247 00:00 145 0.066941 0.128265 0.702247 00:00 146 0.066614 0.128346 0.702247 00:00 147 0.066907 0.128600 0.702247 00:00 148 0.067010 0.128449 0.702247 00:00 149 0.067130 0.128318 0.702247 00:00 Test test = pd.read_csv(test_path) test.head() .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } PassengerId Pclass Name Sex Age SibSp Parch Ticket Fare Cabin Embarked 0 892 3 Kelly, Mr. James male 34.5 0 0 330911 7.8292 NaN Q 1 893 3 Wilkes, Mrs. James (Ellen Needs) female 47.0 1 0 363272 7.0000 NaN S 2 894 2 Myles, Mr. Thomas Francis male 62.0 0 0 240276 9.6875 NaN Q 3 895 3 Wirz, Mr. Albert male 27.0 0 0 315154 8.6625 NaN S 4 896 3 Hirvonen, Mrs. Alexander (Helga E Lindqvist) female 22.0 1 1 3101298 12.2875 NaN S test = test.fillna(0) dl = learn.dls.test_dl(test) result = learn.get_preds(dl=dl) results = pd.DataFrame(columns=['PassengerId', 'Survived']) for i, row in test.iterrows(): pass_id = row['PassengerId'] pred = learn.predict(row) if (pred[1] < 0.5): survived = 0 else: survived = 1 results.loc[i] = [pass_id, survived] results .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } PassengerId Survived 0 892 0 1 893 0 2 894 0 3 895 0 4 896 0 ... ... ... 413 1305 0 414 1306 1 415 1307 0 416 1308 0 417 1309 1 418 rows \u00d7 2 columns results.to_csv('preds.csv', index=False)","title":"Titanic"},{"location":"titanic/#setup","text":"!pip install fastai -U Collecting fastai Downloading fastai-2.0.9-py3-none-any.whl (354 kB) \u001b[K |\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 354 kB 606 kB/s eta 0:00:01 \u001b[?25hRequirement already satisfied, skipping upgrade: packaging in /opt/conda/lib/python3.7/site-packages (from fastai) (20.1) Requirement already satisfied, skipping upgrade: scikit-learn in /opt/conda/lib/python3.7/site-packages (from fastai) (0.23.2) Requirement already satisfied, skipping upgrade: matplotlib in /opt/conda/lib/python3.7/site-packages (from fastai) (3.2.1) Requirement already satisfied, skipping upgrade: pandas in /opt/conda/lib/python3.7/site-packages (from fastai) (1.1.1) Collecting fastcore>=1.0.2 Downloading fastcore-1.0.4-py3-none-any.whl (37 kB) Requirement already satisfied, skipping upgrade: pip in /opt/conda/lib/python3.7/site-packages (from fastai) (20.2.2) Requirement already satisfied, skipping upgrade: fastprogress>=0.2.4 in /opt/conda/lib/python3.7/site-packages (from fastai) (1.0.0) Requirement already satisfied, skipping upgrade: requests in /opt/conda/lib/python3.7/site-packages (from fastai) (2.23.0) Collecting torch>=1.6.0 Downloading torch-1.6.0-cp37-cp37m-manylinux1_x86_64.whl (748.8 MB) \u001b[K |\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 748.8 MB 12 kB/s s eta 0:00:01 |\u2588\u2588 | 46.2 MB 26.8 MB/s eta 0:00:27 |\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e | 309.9 MB 42.0 MB/s eta 0:00:11MB/s eta 0:00:04\ufffd\ufffd\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589 | 674.7 MB 46.3 MB/s eta 0:00:02 \u001b[?25hRequirement already satisfied, skipping upgrade: scipy in /opt/conda/lib/python3.7/site-packages (from fastai) (1.4.1) Requirement already satisfied, skipping upgrade: pyyaml in /opt/conda/lib/python3.7/site-packages (from fastai) (5.3.1) Requirement already satisfied, skipping upgrade: pillow in /opt/conda/lib/python3.7/site-packages (from fastai) (7.2.0) Requirement already satisfied, skipping upgrade: spacy in /opt/conda/lib/python3.7/site-packages (from fastai) (2.2.4) Collecting torchvision>=0.7 Downloading torchvision-0.7.0-cp37-cp37m-manylinux1_x86_64.whl (5.9 MB) \u001b[K |\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 5.9 MB 67.5 MB/s eta 0:00:01 \u001b[?25hRequirement already satisfied, skipping upgrade: six in /opt/conda/lib/python3.7/site-packages (from packaging->fastai) (1.14.0) Requirement already satisfied, skipping upgrade: pyparsing>=2.0.2 in /opt/conda/lib/python3.7/site-packages (from packaging->fastai) (2.4.7) Requirement already satisfied, skipping upgrade: threadpoolctl>=2.0.0 in /opt/conda/lib/python3.7/site-packages (from scikit-learn->fastai) (2.1.0) Requirement already satisfied, skipping upgrade: numpy>=1.13.3 in /opt/conda/lib/python3.7/site-packages (from scikit-learn->fastai) (1.18.5) Requirement already satisfied, skipping upgrade: joblib>=0.11 in /opt/conda/lib/python3.7/site-packages (from scikit-learn->fastai) (0.14.1) Requirement already satisfied, skipping upgrade: kiwisolver>=1.0.1 in /opt/conda/lib/python3.7/site-packages (from matplotlib->fastai) (1.2.0) Requirement already satisfied, skipping upgrade: cycler>=0.10 in /opt/conda/lib/python3.7/site-packages (from matplotlib->fastai) (0.10.0) Requirement already satisfied, skipping upgrade: python-dateutil>=2.1 in /opt/conda/lib/python3.7/site-packages (from matplotlib->fastai) (2.8.1) Requirement already satisfied, skipping upgrade: pytz>=2017.2 in /opt/conda/lib/python3.7/site-packages (from pandas->fastai) (2019.3) Collecting dataclasses Downloading dataclasses-0.6-py3-none-any.whl (14 kB) Requirement already satisfied, skipping upgrade: idna<3,>=2.5 in /opt/conda/lib/python3.7/site-packages (from requests->fastai) (2.9) Requirement already satisfied, skipping upgrade: chardet<4,>=3.0.2 in /opt/conda/lib/python3.7/site-packages (from requests->fastai) (3.0.4) Requirement already satisfied, skipping upgrade: certifi>=2017.4.17 in /opt/conda/lib/python3.7/site-packages (from requests->fastai) (2020.6.20) Requirement already satisfied, skipping upgrade: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /opt/conda/lib/python3.7/site-packages (from requests->fastai) (1.24.3) Requirement already satisfied, skipping upgrade: future in /opt/conda/lib/python3.7/site-packages (from torch>=1.6.0->fastai) (0.18.2) Requirement already satisfied, skipping upgrade: catalogue<1.1.0,>=0.0.7 in /opt/conda/lib/python3.7/site-packages (from spacy->fastai) (1.0.0) Requirement already satisfied, skipping upgrade: srsly<1.1.0,>=1.0.2 in /opt/conda/lib/python3.7/site-packages (from spacy->fastai) (1.0.2) Requirement already satisfied, skipping upgrade: cymem<2.1.0,>=2.0.2 in /opt/conda/lib/python3.7/site-packages (from spacy->fastai) (2.0.3) Requirement already satisfied, skipping upgrade: preshed<3.1.0,>=3.0.2 in /opt/conda/lib/python3.7/site-packages (from spacy->fastai) (3.0.2) Requirement already satisfied, skipping upgrade: tqdm<5.0.0,>=4.38.0 in /opt/conda/lib/python3.7/site-packages (from spacy->fastai) (4.45.0) Requirement already satisfied, skipping upgrade: thinc==7.4.0 in /opt/conda/lib/python3.7/site-packages (from spacy->fastai) (7.4.0) Requirement already satisfied, skipping upgrade: setuptools in /opt/conda/lib/python3.7/site-packages (from spacy->fastai) (46.1.3.post20200325) Requirement already satisfied, skipping upgrade: wasabi<1.1.0,>=0.4.0 in /opt/conda/lib/python3.7/site-packages (from spacy->fastai) (0.7.1) Requirement already satisfied, skipping upgrade: plac<1.2.0,>=0.9.6 in /opt/conda/lib/python3.7/site-packages (from spacy->fastai) (1.1.3) Requirement already satisfied, skipping upgrade: murmurhash<1.1.0,>=0.28.0 in /opt/conda/lib/python3.7/site-packages (from spacy->fastai) (1.0.2) Requirement already satisfied, skipping upgrade: blis<0.5.0,>=0.4.0 in /opt/conda/lib/python3.7/site-packages (from spacy->fastai) (0.4.1) Requirement already satisfied, skipping upgrade: importlib-metadata>=0.20; python_version < \"3.8\" in /opt/conda/lib/python3.7/site-packages (from catalogue<1.1.0,>=0.0.7->spacy->fastai) (1.6.0) Requirement already satisfied, skipping upgrade: zipp>=0.5 in /opt/conda/lib/python3.7/site-packages (from importlib-metadata>=0.20; python_version < \"3.8\"->catalogue<1.1.0,>=0.0.7->spacy->fastai) (3.1.0) Installing collected packages: dataclasses, fastcore, torch, torchvision, fastai Attempting uninstall: torch Found existing installation: torch 1.5.1 Uninstalling torch-1.5.1: Successfully uninstalled torch-1.5.1 Attempting uninstall: torchvision Found existing installation: torchvision 0.6.0a0+35d732a Uninstalling torchvision-0.6.0a0+35d732a: Successfully uninstalled torchvision-0.6.0a0+35d732a Attempting uninstall: fastai Found existing installation: fastai 1.0.61 Uninstalling fastai-1.0.61: Successfully uninstalled fastai-1.0.61 \u001b[31mERROR: After October 2020 you may experience errors when installing or updating packages. This is because pip will change the way that it resolves dependency conflicts. We recommend you use --use-feature=2020-resolver to test your packages with the new resolver before it becomes the default. kornia 0.3.2 requires torch<1.6.0,>=1.5.0, but you'll have torch 1.6.0 which is incompatible. allennlp 1.0.0 requires torch<1.6.0,>=1.5.0, but you'll have torch 1.6.0 which is incompatible.\u001b[0m Successfully installed dataclasses-0.6 fastai-2.0.9 fastcore-1.0.4 torch-1.6.0 torchvision-0.7.0 import fastai fastai.__version__ '2.0.9' from fastai.tabular.all import *","title":"Setup"},{"location":"titanic/#data","text":"path = '../input/titanic' train_path = path + '/train.csv' test_path = path + '/test.csv' train = pd.read_csv(train_path) train.head() .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } PassengerId Survived Pclass Name Sex Age SibSp Parch Ticket Fare Cabin Embarked 0 1 0 3 Braund, Mr. Owen Harris male 22.0 1 0 A/5 21171 7.2500 NaN S 1 2 1 1 Cumings, Mrs. John Bradley (Florence Briggs Thayer) female 38.0 1 0 PC 17599 71.2833 C85 C 2 3 1 3 Heikkinen, Miss. Laina female 26.0 0 0 STON/O2. 3101282 7.9250 NaN S 3 4 1 1 Futrelle, Mrs. Jacques Heath (Lily May Peel) female 35.0 1 0 113803 53.1000 C123 S 4 5 0 3 Allen, Mr. William Henry male 35.0 0 0 373450 8.0500 NaN S train.Parch.describe() count 891.000000 mean 0.381594 std 0.806057 min 0.000000 25% 0.000000 50% 0.000000 75% 0.000000 max 6.000000 Name: Parch, dtype: float64 train.columns Index(['PassengerId', 'Survived', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp', 'Parch', 'Ticket', 'Fare', 'Cabin', 'Embarked'], dtype='object') splits = RandomSplitter(valid_pct=0.2)(range_of(train)) data = TabularPandas( train, procs=[Categorify, FillMissing,Normalize], cat_names = ['Pclass', 'SibSp', 'Sex', 'Parch','Cabin','Embarked'], cont_names = ['Age','Fare'], y_names='Survived', splits=splits)","title":"Data"},{"location":"titanic/#train","text":"dls = data.dataloaders(bs=64) learn = tabular_learner(dls, metrics=accuracy, cbs=ShowGraphCallback()) learn.fit_one_cycle(150) epoch train_loss valid_loss accuracy time 0 0.395150 0.377600 0.702247 00:00 1 0.366346 0.382785 0.702247 00:00 2 0.339551 0.371797 0.702247 00:00 3 0.310264 0.345113 0.702247 00:00 4 0.281579 0.310483 0.702247 00:00 5 0.253278 0.269912 0.702247 00:00 6 0.228688 0.222490 0.702247 00:00 7 0.206920 0.168250 0.702247 00:00 8 0.187758 0.142423 0.702247 00:00 9 0.173925 0.139804 0.702247 00:00 10 0.159615 0.139614 0.702247 00:00 11 0.148577 0.139325 0.702247 00:00 12 0.138739 0.140137 0.702247 00:00 13 0.130475 0.142085 0.702247 00:00 14 0.124002 0.144857 0.702247 00:00 15 0.118234 0.136231 0.702247 00:00 16 0.114288 0.132554 0.702247 00:00 17 0.110318 0.140191 0.702247 00:00 18 0.107971 0.146698 0.702247 00:00 19 0.106027 0.131402 0.702247 00:00 20 0.104463 0.125868 0.702247 00:00 21 0.101879 0.133761 0.702247 00:00 22 0.101234 0.135055 0.702247 00:00 23 0.099686 0.135643 0.702247 00:00 24 0.098142 0.132391 0.702247 00:00 25 0.096319 0.136855 0.702247 00:00 26 0.095436 0.131195 0.702247 00:00 27 0.094448 0.142192 0.702247 00:00 28 0.093358 0.132326 0.702247 00:00 29 0.093689 0.129051 0.702247 00:00 30 0.092883 0.135105 0.702247 00:00 31 0.092068 0.130766 0.702247 00:00 32 0.091736 0.129940 0.702247 00:00 33 0.091531 0.124503 0.702247 00:00 34 0.091348 0.137747 0.702247 00:00 35 0.091168 0.137324 0.702247 00:00 36 0.090646 0.131917 0.702247 00:00 37 0.090659 0.126318 0.702247 00:00 38 0.089957 0.135028 0.702247 00:00 39 0.088891 0.132661 0.702247 00:00 40 0.088472 0.135807 0.702247 00:00 41 0.089196 0.123606 0.702247 00:00 42 0.088436 0.128096 0.702247 00:00 43 0.087570 0.139201 0.702247 00:00 44 0.087807 0.138244 0.702247 00:00 45 0.087348 0.126612 0.702247 00:00 46 0.086900 0.134935 0.702247 00:00 47 0.085824 0.129363 0.702247 00:00 48 0.085647 0.128131 0.702247 00:00 49 0.084996 0.132883 0.702247 00:00 50 0.084723 0.132393 0.702247 00:00 51 0.085479 0.135473 0.702247 00:00 52 0.085324 0.119682 0.702247 00:00 53 0.084677 0.127057 0.702247 00:00 54 0.083926 0.124037 0.702247 00:00 55 0.083732 0.126720 0.702247 00:00 56 0.083126 0.123772 0.702247 00:00 57 0.082183 0.127085 0.702247 00:00 58 0.081710 0.121816 0.702247 00:00 59 0.081324 0.133650 0.702247 00:00 60 0.080935 0.125411 0.702247 00:00 61 0.079854 0.122429 0.702247 00:00 62 0.079330 0.123147 0.702247 00:00 63 0.078994 0.127851 0.702247 00:00 64 0.078510 0.125835 0.702247 00:00 65 0.078242 0.125809 0.702247 00:00 66 0.078397 0.130970 0.702247 00:00 67 0.078568 0.125747 0.702247 00:00 68 0.078034 0.128503 0.702247 00:00 69 0.077501 0.128943 0.702247 00:00 70 0.078080 0.127008 0.702247 00:00 71 0.078011 0.130303 0.702247 00:00 72 0.078300 0.134184 0.702247 00:00 73 0.078497 0.126999 0.702247 00:00 74 0.077963 0.132503 0.702247 00:00 75 0.077654 0.128828 0.702247 00:00 76 0.077370 0.126126 0.702247 00:00 77 0.077282 0.136550 0.702247 00:00 78 0.077126 0.133494 0.702247 00:00 79 0.077159 0.125807 0.702247 00:00 80 0.076400 0.127987 0.702247 00:00 81 0.076187 0.128587 0.702247 00:00 82 0.076069 0.128721 0.702247 00:00 83 0.076213 0.125016 0.702247 00:00 84 0.075244 0.128486 0.702247 00:00 85 0.075067 0.127430 0.702247 00:00 86 0.074768 0.129118 0.702247 00:00 87 0.074301 0.128410 0.702247 00:00 88 0.074128 0.135739 0.702247 00:00 89 0.074148 0.128045 0.702247 00:00 90 0.073939 0.128453 0.702247 00:00 91 0.073921 0.126086 0.702247 00:00 92 0.074096 0.130053 0.702247 00:00 93 0.073546 0.122949 0.702247 00:00 94 0.073346 0.128125 0.702247 00:00 95 0.073310 0.126533 0.702247 00:00 96 0.073573 0.129317 0.702247 00:00 97 0.073582 0.126800 0.702247 00:00 98 0.073473 0.128594 0.702247 00:00 99 0.073284 0.125200 0.702247 00:00 100 0.072751 0.124738 0.702247 00:00 101 0.072512 0.126146 0.702247 00:00 102 0.071901 0.126788 0.702247 00:00 103 0.071661 0.125302 0.702247 00:00 104 0.071546 0.124029 0.702247 00:00 105 0.072271 0.131001 0.702247 00:00 106 0.071937 0.130682 0.702247 00:00 107 0.071824 0.126480 0.702247 00:00 108 0.071382 0.129221 0.702247 00:00 109 0.070794 0.126628 0.702247 00:00 110 0.070226 0.128316 0.702247 00:00 111 0.069880 0.128169 0.702247 00:00 112 0.069817 0.129248 0.702247 00:00 113 0.069672 0.128678 0.702247 00:00 114 0.069629 0.128300 0.702247 00:00 115 0.069487 0.127129 0.702247 00:00 116 0.069680 0.130046 0.702247 00:00 117 0.070286 0.128519 0.702247 00:00 118 0.070371 0.130455 0.702247 00:00 119 0.069868 0.127835 0.702247 00:00 120 0.069722 0.127997 0.702247 00:00 121 0.069743 0.128846 0.702247 00:00 122 0.069512 0.130303 0.702247 00:00 123 0.069306 0.127954 0.702247 00:00 124 0.069228 0.127648 0.702247 00:00 125 0.068845 0.128368 0.702247 00:00 126 0.068312 0.127970 0.702247 00:00 127 0.068361 0.127761 0.702247 00:00 128 0.068524 0.126953 0.702247 00:00 129 0.068360 0.128105 0.702247 00:00 130 0.067600 0.128017 0.702247 00:00 131 0.067673 0.127634 0.702247 00:00 132 0.067922 0.127794 0.702247 00:00 133 0.067675 0.128400 0.702247 00:00 134 0.067862 0.128138 0.702247 00:00 135 0.067819 0.127842 0.702247 00:00 136 0.067793 0.127731 0.702247 00:00 137 0.067287 0.128053 0.702247 00:00 138 0.067367 0.128029 0.702247 00:00 139 0.067287 0.128088 0.702247 00:00 140 0.067190 0.127882 0.702247 00:00 141 0.067167 0.128510 0.702247 00:00 142 0.067394 0.127965 0.702247 00:00 143 0.067163 0.128741 0.702247 00:00 144 0.067221 0.128624 0.702247 00:00 145 0.066941 0.128265 0.702247 00:00 146 0.066614 0.128346 0.702247 00:00 147 0.066907 0.128600 0.702247 00:00 148 0.067010 0.128449 0.702247 00:00 149 0.067130 0.128318 0.702247 00:00","title":"Train"},{"location":"titanic/#test","text":"test = pd.read_csv(test_path) test.head() .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } PassengerId Pclass Name Sex Age SibSp Parch Ticket Fare Cabin Embarked 0 892 3 Kelly, Mr. James male 34.5 0 0 330911 7.8292 NaN Q 1 893 3 Wilkes, Mrs. James (Ellen Needs) female 47.0 1 0 363272 7.0000 NaN S 2 894 2 Myles, Mr. Thomas Francis male 62.0 0 0 240276 9.6875 NaN Q 3 895 3 Wirz, Mr. Albert male 27.0 0 0 315154 8.6625 NaN S 4 896 3 Hirvonen, Mrs. Alexander (Helga E Lindqvist) female 22.0 1 1 3101298 12.2875 NaN S test = test.fillna(0) dl = learn.dls.test_dl(test) result = learn.get_preds(dl=dl) results = pd.DataFrame(columns=['PassengerId', 'Survived']) for i, row in test.iterrows(): pass_id = row['PassengerId'] pred = learn.predict(row) if (pred[1] < 0.5): survived = 0 else: survived = 1 results.loc[i] = [pass_id, survived] results .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } PassengerId Survived 0 892 0 1 893 0 2 894 0 3 895 0 4 896 0 ... ... ... 413 1305 0 414 1306 1 415 1307 0 416 1308 0 417 1309 1 418 rows \u00d7 2 columns results.to_csv('preds.csv', index=False)","title":"Test"}]}